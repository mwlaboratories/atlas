#+TITLE: Atlas Keyboard
#+OPTIONS: toc:nil num:nil

[[atlas-render.png]]

[[atlas-update.jpeg]]

* Atlas
34-key split keyboard with TrackPoint and Trackball, using XIAO BLE controllers and a dongle.

** Status (Dec 2025)
- Left side TrackPoint working (Sprintek all-in-one module)
- Standalone PMW3610 trackball working as third peripheral
- Mouse layer auto-activates on trackpoint/trackball movement
- Snipe mode (slow cursor) and scroll mode working
- Press-to-select (tap trackpoint = left click) working

** Architecture
#+begin_example
Dongle (central) <-- Left (trackpoint) + Right (trackpoint) + Trackball (PMW3610)
#+end_example

** Mouse Layer
When moving trackpoint or trackball, layer 5 auto-activates for 1 second.

#+begin_example
Top row keys:
|   | W=SNIPE | E=SCROLL |   |   |   |   | I=SCROLL | O=SNIPE |   |

Thumb keys:
| RCLK | LCLK | LCLK | RCLK |
#+end_example

- *Snipe* (W/O): Hold for 1/4 cursor speed (precision mode)
- *Scroll* (E/I): Hold to convert movement to scroll wheel (1/8 speed)

** Hardware Notes
- TrackPoint: Random crashes may need shorter wires or external pull-up resistors on CLK/DATA
- Trackball: Uses 3-wire SPI (MOSI/MISO shared on D9)

** Build
#+begin_src bash
nix develop
just build all
#+end_src

** Flashing After Config Changes
If peripheral count changes, must re-pair all devices:
1. Flash =settings_reset= to all devices
2. Flash new firmware to all
3. Power on dongle first, then peripherals
